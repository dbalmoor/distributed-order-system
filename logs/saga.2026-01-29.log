Starting InventoryServiceApplication using Java 17.0.12 with PID 23968 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Starting OrderServiceApplication using Java 17.0.12 with PID 39912 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Starting OrderServiceApplication using Java 17.0.12 with PID 31580 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 6.277 seconds (process running for 6.699)
Starting InventoryServiceApplication using Java 17.0.12 with PID 15700 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 5.005 seconds (process running for 5.41)
Starting InventoryServiceApplication using Java 17.0.12 with PID 15520 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 5.8 seconds (process running for 6.217)
Starting InventoryServiceApplication using Java 17.0.12 with PID 2468 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 4.759 seconds (process running for 5.16)
Starting InventoryServiceApplication using Java 17.0.12 with PID 39020 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 4.787 seconds (process running for 5.188)
Starting InventoryServiceApplication using Java 17.0.12 with PID 37988 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Starting OrderServiceApplication using Java 17.0.12 with PID 38576 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 5.511 seconds (process running for 5.927)
Started OrderServiceApplication in 5.753 seconds (process running for 6.173)
Order event sent: {"orderId":29,"orderNumber":"ORD-7862b364","userId":123,"totalAmount":1200,"items":[{"productId":1,"quantity":1,"price":1200}],"createdAt":"2026-01-29T19:33:53.2832006"}
[SAGA] [ORDER] [ORDER:ORD-7862b364] [ORDER_CREATED] [SUCCESS] at 2026-01-29T19:33:53.805123900
Received order: ORD-7862b364
[SAGA] [INVENTORY] [ORDER:ORD-7862b364] [RECEIVED_ORDER] [SUCCESS] at 2026-01-29T19:33:54.175613300
[SAGA] [INVENTORY] [ORDER:ORD-7862b364] [CHECKING_STOCK] [SUCCESS] at 2026-01-29T19:33:54.176385500
[SAGA] [INVENTORY] [ORDER:ORD-7862b364] [FOUND_PRODUCT_1] [SUCCESS] at 2026-01-29T19:33:55.133823400
[SAGA] [INVENTORY] [ORDER:ORD-7862b364] [RESERVED_PRODUCT_1] [SUCCESS] at 2026-01-29T19:33:55.182289500
Inventory reserved event sent: {"orderNumber":"ORD-7862b364","orderId":29,"amount":1200}
[SAGA] [INVENTORY] [ORDER:ORD-7862b364] [EVENT_PUBLISHED] [SUCCESS] at 2026-01-29T19:33:55.264965800
Received inventory.reserved: {"orderNumber":"ORD-7862b364","orderId":29,"amount":1200}
Order ORD-7862b364 CONFIRMED
[SAGA] [ORDER] [ORDER:ORD-7862b364] [INVENTORY_RESERVED] [SUCCESS] at 2026-01-29T19:33:55.395778300
Received payment.success {"orderId":29,"orderNumber":"ORD-7862b364"}
[SAGA] [ORDER] [ORDER:ORD-7862b364] [PAYMENT_SUCCESS] [SUCCESS] at 2026-01-29T19:33:55.604248600
Order ORD-7862b364 COMPLETED
Starting InventoryServiceApplication using Java 17.0.12 with PID 11676 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 5.929 seconds (process running for 6.341)
Order event sent: {"orderId":30,"orderNumber":"ORD-95df4fb3","userId":134,"totalAmount":12000000,"items":[{"productId":1,"quantity":10000,"price":1200}],"createdAt":"2026-01-29T19:45:11.9263058"}
[SAGA] [ORDER] [ORDER:ORD-95df4fb3] [ORDER_CREATED] [SUCCESS] at 2026-01-29T19:45:11.942551100
Received order: ORD-95df4fb3
[SAGA] [INVENTORY] [ORDER:ORD-95df4fb3] [RECEIVED_ORDER] [SUCCESS] at 2026-01-29T19:45:12.199556900
[SAGA] [INVENTORY] [ORDER:ORD-95df4fb3] [CHECKING_STOCK] [SUCCESS] at 2026-01-29T19:45:12.199556900
[SAGA] [INVENTORY] [ORDER:ORD-95df4fb3] [FOUND_PRODUCT_1] [SUCCESS] at 2026-01-29T19:45:14.199403
[SAGA] [INVENTORY] [ORDER:ORD-95df4fb3] [INSUFFICIENT_STOCK_PRODUCT_1] [FAILED] at 2026-01-29T19:45:14.200143600
Inventory failed event sent: {"orderId":30,"orderNumber":"ORD-95df4fb3","reason":"Insufficient stock"}
[SAGA] [INVENTORY] [ORDER:ORD-95df4fb3] [EVENT_PUBLISHED_FAILED] [FAILED] at 2026-01-29T19:45:14.471178800
Inventory FAILED for order ORD-95df4fb3 : Insufficient stock
Received inventory.failed {"orderId":30,"orderNumber":"ORD-95df4fb3","reason":"Insufficient stock"}
[SAGA] [ORDER] [ORDER:ORD-95df4fb3] [INVENTORY_FAILED] [FAILED] at 2026-01-29T19:45:14.543280
Inventory failed for order ORD-95df4fb3
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Starting OrderServiceApplication using Java 17.0.12 with PID 28644 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 10.38 seconds (process running for 10.656)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Starting InventoryServiceApplication using Java 17.0.12 with PID 45160 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 3.341 seconds (process running for 3.571)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'invalid': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 8]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2633)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:831)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._reportInvalidToken(ReaderBasedJsonParser.java:3017)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2051)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:780)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Illegal character ((CTRL-CHAR, code 27)): only regular white space (\r, \n, \t) is allowed between tokens
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._throwInvalidSpace(ParserMinimalBase.java:778)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2508)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Illegal character ((CTRL-CHAR, code 27)): only regular white space (\r, \n, \t) is allowed between tokens
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._throwInvalidSpace(ParserMinimalBase.java:778)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2508)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.core.JsonParseException: Illegal character ((CTRL-CHAR, code 27)): only regular white space (\r, \n, \t) is allowed between tokens
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 2]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2599)
	at com.fasterxml.jackson.core.JsonParser._constructReadException(JsonParser.java:2625)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._throwInvalidSpace(ParserMinimalBase.java:778)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2508)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:673)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:5125)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5028)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Starting OrderServiceApplication using Java 17.0.12 with PID 5752 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.52 seconds (process running for 3.762)
Starting OrderServiceApplication using Java 17.0.12 with PID 32568 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Starting InventoryServiceApplication using Java 17.0.12 with PID 18840 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.961 seconds (process running for 4.214)
Started InventoryServiceApplication in 3.386 seconds (process running for 3.637)
Order event sent: {"orderId":31,"orderNumber":"ORD-1169de8d","userId":134,"totalAmount":1200,"items":[{"productId":null,"quantity":null,"price":null,"traceId":null}],"createdAt":"2026-01-29T21:18:15.8306289","traceId":"ORD-1169de8d"}
[SAGA] [ORDER] [ORDER:ORD-1169de8d] [ORD-1169de8d] [ORDER_CREATED] at SUCCESS
Inventory processing failed
com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException: Unrecognized field "traceId" (class com.deepana.inventoryservice.dto.events.OrderItemEvent), not marked as ignorable (3 known properties: "price", "productId", "quantity"])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 146] (through reference chain: com.deepana.inventoryservice.dto.events.OrderCreatedEvent["items"]->java.util.ArrayList[0]->com.deepana.inventoryservice.dto.events.OrderItemEvent["traceId"])
	at com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException.from(UnrecognizedPropertyException.java:61)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnknownProperty(DeserializationContext.java:1208)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer.handleUnknownProperty(StdDeserializer.java:2380)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownProperty(BeanDeserializerBase.java:1823)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownVanilla(BeanDeserializerBase.java:1801)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:308)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:169)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeNoNullChecks(CollectionDeserializer.java:545)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:358)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:245)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:29)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:302)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:169)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5038)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:30)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException: Unrecognized field "traceId" (class com.deepana.inventoryservice.dto.events.OrderItemEvent), not marked as ignorable (3 known properties: "price", "productId", "quantity"])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 146] (through reference chain: com.deepana.inventoryservice.dto.events.OrderCreatedEvent["items"]->java.util.ArrayList[0]->com.deepana.inventoryservice.dto.events.OrderItemEvent["traceId"])
	at com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException.from(UnrecognizedPropertyException.java:61)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnknownProperty(DeserializationContext.java:1208)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer.handleUnknownProperty(StdDeserializer.java:2380)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownProperty(BeanDeserializerBase.java:1823)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownVanilla(BeanDeserializerBase.java:1801)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:308)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:169)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeNoNullChecks(CollectionDeserializer.java:545)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:358)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:245)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:29)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:302)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:169)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5038)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:30)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Inventory processing failed
com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException: Unrecognized field "traceId" (class com.deepana.inventoryservice.dto.events.OrderItemEvent), not marked as ignorable (3 known properties: "price", "productId", "quantity"])
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 146] (through reference chain: com.deepana.inventoryservice.dto.events.OrderCreatedEvent["items"]->java.util.ArrayList[0]->com.deepana.inventoryservice.dto.events.OrderItemEvent["traceId"])
	at com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException.from(UnrecognizedPropertyException.java:61)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnknownProperty(DeserializationContext.java:1208)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer.handleUnknownProperty(StdDeserializer.java:2380)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownProperty(BeanDeserializerBase.java:1823)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownVanilla(BeanDeserializerBase.java:1801)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:308)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:169)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeNoNullChecks(CollectionDeserializer.java:545)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:358)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:245)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:29)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:129)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:302)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:169)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:342)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:5038)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3954)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3922)
	at com.deepana.inventoryservice.kafka.OrderEventConsumer.consumeOrderCreated(OrderEventConsumer.java:30)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Starting OrderServiceApplication using Java 17.0.12 with PID 32928 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.352 seconds (process running for 3.585)
Order event sent: {"orderId":32,"orderNumber":"ORD-c2d5a593","userId":134,"totalAmount":1200,"items":[{"productId":1,"quantity":1,"price":1200}],"createdAt":"2026-01-29T21:19:48.7703854","traceId":"ORD-c2d5a593"}
[SAGA] [ORDER] [ORDER:ORD-c2d5a593] [ORD-c2d5a593] [ORDER_CREATED] at SUCCESS
Received order: ORD-c2d5a593
[SAGA] [INVENTORY] [ORDER:ORD-c2d5a593] [ORD-c2d5a593] [RECEIVED_ORDER] at SUCCESS
[SAGA] [INVENTORY] [ORDER:ORD-c2d5a593] [ORD-c2d5a593] [CHECKING_STOCK] at SUCCESS
[SAGA] [INVENTORY] [ORDER:ORD-c2d5a593] [ORD-c2d5a593] [FOUND_PRODUCT_1] at SUCCESS
[SAGA] [INVENTORY] [ORDER:ORD-c2d5a593] [ORD-c2d5a593] [RESERVED_PRODUCT_1] at SUCCESS
Inventory reserved event sent: {"orderNumber":"ORD-c2d5a593","orderId":32,"amount":1200,"traceId":"ORD-c2d5a593"}
[SAGA] [INVENTORY] [ORDER:ORD-c2d5a593] [ORD-c2d5a593] [EVENT_PUBLISHED] at SUCCESS
Received inventory.reserved: {"orderNumber":"ORD-c2d5a593","orderId":32,"amount":1200,"traceId":"ORD-c2d5a593"}
Order ORD-c2d5a593 CONFIRMED
[SAGA] [ORDER] [ORDER:null] [ORD-c2d5a593] [INVENTORY_RESERVED] at SUCCESS
Received payment.success {"orderId":32,"orderNumber":"ORD-c2d5a593","traceId":"ORD-c2d5a593"}
[SAGA] [ORDER] [ORDER:ORD-c2d5a593] [ORD-c2d5a593] [PAYMENT_SUCCESS] at SUCCESS
Order ORD-c2d5a593 COMPLETED
Starting InventoryServiceApplication using Java 17.0.12 with PID 8296 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 3.264 seconds (process running for 3.496)
Starting OrderServiceApplication using Java 17.0.12 with PID 38092 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.353 seconds (process running for 3.581)
Order event sent: {"orderId":33,"orderNumber":"ORD-f512e798","userId":134,"totalAmount":1200,"items":[{"productId":1,"quantity":1,"price":1200}],"createdAt":"2026-01-29T21:27:56.2331916","traceId":"ORD-f512e798"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-f512e798] [ORDER:ORD-f512e798] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T21:27:56.336492600
Received order: ORD-f512e798
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-f512e798] [ORDER:ORD-f512e798] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T21:27:56.415579
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-f512e798] [ORDER:ORD-f512e798] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T21:27:56.416603
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-f512e798] [ORDER:ORD-f512e798] [STEP:FOUND_PRODUCT_1] [STATUS:SUCCESS] at 2026-01-29T21:27:56.696361600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-f512e798] [ORDER:ORD-f512e798] [STEP:RESERVED_PRODUCT_1] [STATUS:SUCCESS] at 2026-01-29T21:27:56.720411300
Inventory reserved event sent: {"orderNumber":"ORD-f512e798","orderId":33,"amount":1200,"traceId":"ORD-f512e798"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-f512e798] [ORDER:ORD-f512e798] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T21:27:56.770044900
Received inventory.reserved: {"orderNumber":"ORD-f512e798","orderId":33,"amount":1200,"traceId":"ORD-f512e798"}
Order ORD-f512e798 CONFIRMED
[SAGA] [SERVICE:ORDER] [TRACE:null] [ORDER:ORD-f512e798] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T21:27:56.850417600
Received payment.success {"orderId":33,"orderNumber":"ORD-f512e798","traceId":"ORD-f512e798"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-f512e798] [ORDER:ORD-f512e798] [STEP:PAYMENT_SUCCESS] [STATUS:SUCCESS] at 2026-01-29T21:27:56.957444100
Order ORD-f512e798 COMPLETED
Starting InventoryServiceApplication using Java 17.0.12 with PID 22340 (F:\PROJECTS\git\distributed-order-system\inventory-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Starting OrderServiceApplication using Java 17.0.12 with PID 26112 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started InventoryServiceApplication in 3.615 seconds (process running for 3.857)
Started OrderServiceApplication in 3.805 seconds (process running for 4.059)
Order event sent: {"orderId":34,"orderNumber":"ORD-ebdee342","userId":134,"totalAmount":1200,"items":[{"productId":1,"quantity":1,"price":1200}],"createdAt":"2026-01-29T21:57:52.4891797","traceId":"ORD-ebdee342"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-ebdee342] [ORDER:ORD-ebdee342] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T21:57:52.776282500
Received order: ORD-ebdee342
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ebdee342] [ORDER:ORD-ebdee342] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T21:57:52.947299700
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ebdee342] [ORDER:ORD-ebdee342] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T21:57:52.947299700
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ebdee342] [ORDER:ORD-ebdee342] [STEP:FOUND_PRODUCT_1] [STATUS:SUCCESS] at 2026-01-29T21:57:53.733797300
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ebdee342] [ORDER:ORD-ebdee342] [STEP:RESERVED_PRODUCT_1] [STATUS:SUCCESS] at 2026-01-29T21:57:53.768594500
Inventory reserved event sent: {"orderNumber":"ORD-ebdee342","orderId":34,"amount":1200,"traceId":"ORD-ebdee342"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ebdee342] [ORDER:ORD-ebdee342] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T21:57:53.829604600
Received inventory.reserved: {"orderNumber":"ORD-ebdee342","orderId":34,"amount":1200,"traceId":"ORD-ebdee342"}
Order ORD-ebdee342 CONFIRMED
[SAGA] [SERVICE:ORDER] [TRACE:null] [ORDER:ORD-ebdee342] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T21:57:53.926385600
Received payment.failed {"orderId":34,"orderNumber":"ORD-ebdee342","reason":"Payment gateway declined","traceId":"ORD-ebdee342"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-ebdee342] [ORDER:ORD-ebdee342] [STEP:PAYMENT_FAILED] [STATUS:FAILED] at 2026-01-29T21:57:54.095531500
Payment failed for order ORD-ebdee342 : Payment gateway declined
Starting OrderServiceApplication using Java 17.0.12 with PID 21992 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 4.906 seconds (process running for 5.137)
Order event sent: {"orderId":35,"orderNumber":"ORD-1f170cea","userId":134,"totalAmount":1200,"items":[{"productId":1,"quantity":1,"price":1200}],"createdAt":"2026-01-29T22:03:28.3768937","traceId":"ORD-1f170cea"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-1f170cea] [ORDER:ORD-1f170cea] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:03:28.478380300
Received order: ORD-1f170cea
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1f170cea] [ORDER:ORD-1f170cea] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:03:28.505438
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1f170cea] [ORDER:ORD-1f170cea] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:03:28.505438
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1f170cea] [ORDER:ORD-1f170cea] [STEP:FOUND_PRODUCT_1] [STATUS:SUCCESS] at 2026-01-29T22:03:28.510469500
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1f170cea] [ORDER:ORD-1f170cea] [STEP:RESERVED_PRODUCT_1] [STATUS:SUCCESS] at 2026-01-29T22:03:28.512476600
Inventory reserved event sent: {"orderNumber":"ORD-1f170cea","orderId":35,"amount":1200,"traceId":"ORD-1f170cea"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1f170cea] [ORDER:ORD-1f170cea] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:03:28.515843700
Received inventory.reserved: {"orderNumber":"ORD-1f170cea","orderId":35,"amount":1200,"traceId":"ORD-1f170cea"}
Received payment.success {"orderId":35,"orderNumber":"ORD-1f170cea","traceId":"ORD-1f170cea"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-1f170cea] [ORDER:ORD-1f170cea] [STEP:PAYMENT_SUCCESS] [STATUS:SUCCESS] at 2026-01-29T22:03:28.572199
Order ORD-1f170cea COMPLETED
Failed to process inventory.reserved
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '35']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:166)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy160.save(Unknown Source)
	at com.deepana.orderservice.kafka.listener.InventoryEventListener.handleInventoryReserved(InventoryEventListener.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '35']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 36 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 61 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 37712 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.387 seconds (process running for 3.639)
Order event sent: {"orderId":36,"orderNumber":"ORD-3e8e6d80","userId":134,"totalAmount":1200,"items":[{"productId":2,"quantity":1,"price":1200}],"createdAt":"2026-01-29T22:05:21.1792306","traceId":"ORD-3e8e6d80"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-3e8e6d80] [ORDER:ORD-3e8e6d80] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:05:21.292607700
Received order: ORD-3e8e6d80
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3e8e6d80] [ORDER:ORD-3e8e6d80] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:05:21.324136600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3e8e6d80] [ORDER:ORD-3e8e6d80] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:05:21.324136600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3e8e6d80] [ORDER:ORD-3e8e6d80] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:05:21.327180300
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3e8e6d80] [ORDER:ORD-3e8e6d80] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:05:21.328684200
Inventory reserved event sent: {"orderNumber":"ORD-3e8e6d80","orderId":36,"amount":1200,"traceId":"ORD-3e8e6d80"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3e8e6d80] [ORDER:ORD-3e8e6d80] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:05:21.329712600
Received payment.failed {"orderId":36,"orderNumber":"ORD-3e8e6d80","reason":"Payment gateway declined","traceId":"ORD-3e8e6d80"}
Received inventory.reserved ORD-3e8e6d80
[SAGA] [SERVICE:ORDER] [TRACE:ORD-3e8e6d80] [ORDER:ORD-3e8e6d80] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T22:05:21.404999700
[SAGA] [SERVICE:ORDER] [TRACE:ORD-3e8e6d80] [ORDER:ORD-3e8e6d80] [STEP:PAYMENT_FAILED] [STATUS:FAILED] at 2026-01-29T22:05:21.404999700
Inventory reserved for order ORD-3e8e6d80
Payment failed for order ORD-3e8e6d80 : Payment gateway declined
Failed to process payment.failed
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '36']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at com.deepana.orderservice.service.OrderServiceImpl$$SpringCGLIB$$0.handlePaymentFailure(<generated>)
	at com.deepana.orderservice.kafka.PaymentEventConsumer.handleFailed(PaymentEventConsumer.java:56)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '36']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 32 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 57 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 44476 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 11.889 seconds (process running for 12.711)
Order event sent: {"orderId":37,"orderNumber":"ORD-a1d6168a","userId":135,"totalAmount":1200,"items":[{"productId":2,"quantity":1,"price":1200}],"createdAt":"2026-01-29T22:06:46.4638715","traceId":"ORD-a1d6168a"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-a1d6168a] [ORDER:ORD-a1d6168a] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:06:46.710014500
Received order: ORD-a1d6168a
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-a1d6168a] [ORDER:ORD-a1d6168a] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:06:46.739793300
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-a1d6168a] [ORDER:ORD-a1d6168a] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:06:46.739793300
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-a1d6168a] [ORDER:ORD-a1d6168a] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:06:46.745759
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-a1d6168a] [ORDER:ORD-a1d6168a] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:06:46.752308200
Inventory reserved event sent: {"orderNumber":"ORD-a1d6168a","orderId":37,"amount":1200,"traceId":"ORD-a1d6168a"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-a1d6168a] [ORDER:ORD-a1d6168a] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:06:46.752308200
Received inventory.reserved {"orderNumber":"ORD-a1d6168a","orderId":37,"amount":1200,"traceId":"ORD-a1d6168a"}
Received payment.success {"orderId":37,"orderNumber":"ORD-a1d6168a","traceId":"ORD-a1d6168a"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-a1d6168a] [ORDER:ORD-a1d6168a] [STEP:PAYMENT_SUCCESS] [STATUS:SUCCESS] at 2026-01-29T22:06:46.891341800
[SAGA] [SERVICE:ORDER] [TRACE:ORD-a1d6168a] [ORDER:ORD-a1d6168a] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T22:06:46.891341800
Order ORD-a1d6168a COMPLETED
Inventory reserved for order ORD-a1d6168a
Failed to process payment.success
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '37']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at com.deepana.orderservice.service.OrderServiceImpl$$SpringCGLIB$$0.handlePaymentSuccess(<generated>)
	at com.deepana.orderservice.kafka.PaymentEventConsumer.handleSuccess(PaymentEventConsumer.java:34)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '37']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 32 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 57 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 33236 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 10.914 seconds (process running for 11.728)
Order event sent: {"orderId":38,"orderNumber":"ORD-ab55d2c0","userId":135,"totalAmount":1200,"items":[{"productId":2,"quantity":1,"price":1200}],"createdAt":"2026-01-29T22:10:52.8526049","traceId":"ORD-ab55d2c0"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-ab55d2c0] [ORDER:ORD-ab55d2c0] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:10:52.950492600
Received order: ORD-ab55d2c0
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ab55d2c0] [ORDER:ORD-ab55d2c0] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:10:52.976967400
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ab55d2c0] [ORDER:ORD-ab55d2c0] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:10:52.976967400
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ab55d2c0] [ORDER:ORD-ab55d2c0] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:10:52.980085700
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ab55d2c0] [ORDER:ORD-ab55d2c0] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:10:52.982160100
Inventory reserved event sent: {"orderNumber":"ORD-ab55d2c0","orderId":38,"amount":1200,"traceId":"ORD-ab55d2c0"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-ab55d2c0] [ORDER:ORD-ab55d2c0] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:10:52.982160100
Received inventory.reserved: {"orderNumber":"ORD-ab55d2c0","orderId":38,"amount":1200,"traceId":"ORD-ab55d2c0"}
Received payment.success {"orderId":38,"orderNumber":"ORD-ab55d2c0","traceId":"ORD-ab55d2c0"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-ab55d2c0] [ORDER:ORD-ab55d2c0] [STEP:PAYMENT_SUCCESS] [STATUS:SUCCESS] at 2026-01-29T22:10:53.059887300
Order ORD-ab55d2c0 COMPLETED
Failed to process inventory.reserved
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '38']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:166)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy160.save(Unknown Source)
	at com.deepana.orderservice.kafka.listener.InventoryEventListener.handleInventoryReserved(InventoryEventListener.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '38']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 36 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 61 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 25232 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.419 seconds (process running for 3.643)
Order event sent: {"orderId":39,"orderNumber":"ORD-4ec52dff","userId":135,"totalAmount":1200,"items":[{"productId":2,"quantity":1,"price":1200}],"createdAt":"2026-01-29T22:20:38.5031514","traceId":"ORD-4ec52dff"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-4ec52dff] [ORDER:ORD-4ec52dff] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:20:38.716736900
Received order: ORD-4ec52dff
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-4ec52dff] [ORDER:ORD-4ec52dff] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:20:38.739863
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-4ec52dff] [ORDER:ORD-4ec52dff] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:20:38.739863
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-4ec52dff] [ORDER:ORD-4ec52dff] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:20:38.744127100
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-4ec52dff] [ORDER:ORD-4ec52dff] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:20:38.746413100
Inventory reserved event sent: {"orderNumber":"ORD-4ec52dff","orderId":39,"amount":1200,"traceId":"ORD-4ec52dff"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-4ec52dff] [ORDER:ORD-4ec52dff] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:20:38.748735700
Received inventory.reserved: {"orderNumber":"ORD-4ec52dff","orderId":39,"amount":1200,"traceId":"ORD-4ec52dff"}
Received payment.failed {"orderId":39,"orderNumber":"ORD-4ec52dff","reason":"Payment gateway declined","traceId":"ORD-4ec52dff"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-4ec52dff] [ORDER:ORD-4ec52dff] [STEP:PAYMENT_FAILED] [STATUS:FAILED] at 2026-01-29T22:20:38.833323400
Payment failed for order ORD-4ec52dff : Payment gateway declined
Failed to process inventory.reserved
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '39']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:166)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy160.save(Unknown Source)
	at com.deepana.orderservice.kafka.listener.InventoryEventListener.handleInventoryReserved(InventoryEventListener.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '39']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 36 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 61 common frames omitted
Order event sent: {"orderId":40,"orderNumber":"ORD-1378fa52","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T22:20:59.5759255","traceId":"ORD-1378fa52"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-1378fa52] [ORDER:ORD-1378fa52] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:20:59.579519600
Received order: ORD-1378fa52
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1378fa52] [ORDER:ORD-1378fa52] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:20:59.592899500
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1378fa52] [ORDER:ORD-1378fa52] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:20:59.592899500
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1378fa52] [ORDER:ORD-1378fa52] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:20:59.598670600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1378fa52] [ORDER:ORD-1378fa52] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:20:59.602289900
Inventory reserved event sent: {"orderNumber":"ORD-1378fa52","orderId":40,"amount":100,"traceId":"ORD-1378fa52"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-1378fa52] [ORDER:ORD-1378fa52] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:20:59.602289900
Received inventory.reserved {"orderNumber":"ORD-1378fa52","orderId":40,"amount":100,"traceId":"ORD-1378fa52"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-1378fa52] [ORDER:ORD-1378fa52] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T22:20:59.627262900
Received payment.success {"orderId":40,"orderNumber":"ORD-1378fa52","traceId":"ORD-1378fa52"}
Skipping payment success. Current=INVENTORY_RESERVED
Starting OrderServiceApplication using Java 17.0.12 with PID 6336 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.493 seconds (process running for 3.723)
Order event sent: {"orderId":41,"orderNumber":"ORD-8f5bd376","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T22:23:16.5236419","traceId":"ORD-8f5bd376"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-8f5bd376] [ORDER:ORD-8f5bd376] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:23:16.624238100
Received order: ORD-8f5bd376
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-8f5bd376] [ORDER:ORD-8f5bd376] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:23:16.639502
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-8f5bd376] [ORDER:ORD-8f5bd376] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:23:16.639502
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-8f5bd376] [ORDER:ORD-8f5bd376] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:23:16.644093200
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-8f5bd376] [ORDER:ORD-8f5bd376] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:23:16.645829200
Inventory reserved event sent: {"orderNumber":"ORD-8f5bd376","orderId":41,"amount":100,"traceId":"ORD-8f5bd376"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-8f5bd376] [ORDER:ORD-8f5bd376] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:23:16.645829200
Received payment.failed {"orderId":41,"orderNumber":"ORD-8f5bd376","reason":"Payment gateway declined","traceId":"ORD-8f5bd376"}
Received inventory.reserved {"orderNumber":"ORD-8f5bd376","orderId":41,"amount":100,"traceId":"ORD-8f5bd376"}
Invalid payment failure state. Current=CREATED
[SAGA] [SERVICE:ORDER] [TRACE:ORD-8f5bd376] [ORDER:ORD-8f5bd376] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T22:23:16.718710600
Starting OrderServiceApplication using Java 17.0.12 with PID 9840 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.364 seconds (process running for 3.602)
Order event sent: {"orderId":42,"orderNumber":"ORD-c3f96f34","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T22:31:37.1924861","traceId":"ORD-c3f96f34"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-c3f96f34] [ORDER:ORD-c3f96f34] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:31:37.310654100
Received order: ORD-c3f96f34
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c3f96f34] [ORDER:ORD-c3f96f34] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:31:37.340773500
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c3f96f34] [ORDER:ORD-c3f96f34] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:31:37.340773500
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c3f96f34] [ORDER:ORD-c3f96f34] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:31:37.346780300
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c3f96f34] [ORDER:ORD-c3f96f34] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:31:37.349146100
Inventory reserved event sent: {"orderNumber":"ORD-c3f96f34","orderId":42,"amount":100,"traceId":"ORD-c3f96f34"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c3f96f34] [ORDER:ORD-c3f96f34] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:31:37.349146100
Received payment.success {"orderId":42,"orderNumber":"ORD-c3f96f34","traceId":"ORD-c3f96f34"}
Received inventory.reserved {"orderNumber":"ORD-c3f96f34","orderId":42,"amount":100,"traceId":"ORD-c3f96f34"}
Skipping payment success. Current=CREATED
[SAGA] [SERVICE:ORDER] [TRACE:ORD-c3f96f34] [ORDER:ORD-c3f96f34] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T22:31:37.429236500
Inventory reserved for order ORD-c3f96f34
Starting OrderServiceApplication using Java 17.0.12 with PID 16112 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.469 seconds (process running for 3.696)
Order event sent: {"orderId":43,"orderNumber":"ORD-3a2aa579","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T22:40:07.4034248","traceId":"ORD-3a2aa579"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-3a2aa579] [ORDER:ORD-3a2aa579] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:40:07.507413600
Received order: ORD-3a2aa579
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3a2aa579] [ORDER:ORD-3a2aa579] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:40:07.524301600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3a2aa579] [ORDER:ORD-3a2aa579] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:40:07.524301600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3a2aa579] [ORDER:ORD-3a2aa579] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:40:07.527389
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3a2aa579] [ORDER:ORD-3a2aa579] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:40:07.530419700
Inventory reserved event sent: {"orderNumber":"ORD-3a2aa579","orderId":43,"amount":100,"traceId":"ORD-3a2aa579"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3a2aa579] [ORDER:ORD-3a2aa579] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:40:07.533265500
Received payment.success {"orderId":43,"orderNumber":"ORD-3a2aa579","traceId":"ORD-3a2aa579"}
Received inventory.reserved {"orderNumber":"ORD-3a2aa579","orderId":43,"amount":100,"traceId":"ORD-3a2aa579"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-3a2aa579] [ORDER:ORD-3a2aa579] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T22:40:07.602243500
Payment success pending for ORD-3a2aa579
Inventory reserved for ORD-3a2aa579
Failed to process payment.success
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '43']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at com.deepana.orderservice.service.OrderServiceImpl$$SpringCGLIB$$0.handlePaymentSuccess(<generated>)
	at com.deepana.orderservice.kafka.PaymentEventConsumer.handleSuccess(PaymentEventConsumer.java:34)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '43']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 32 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 57 common frames omitted
Order event sent: {"orderId":44,"orderNumber":"ORD-32ee8a71","userId":135,"totalAmount":10,"items":[{"productId":2,"quantity":1,"price":10}],"createdAt":"2026-01-29T22:40:26.3341212","traceId":"ORD-32ee8a71"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-32ee8a71] [ORDER:ORD-32ee8a71] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:40:26.336568600
Received order: ORD-32ee8a71
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-32ee8a71] [ORDER:ORD-32ee8a71] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:40:26.356491900
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-32ee8a71] [ORDER:ORD-32ee8a71] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:40:26.356491900
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-32ee8a71] [ORDER:ORD-32ee8a71] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:40:26.361235500
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-32ee8a71] [ORDER:ORD-32ee8a71] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:40:26.362854
Inventory reserved event sent: {"orderNumber":"ORD-32ee8a71","orderId":44,"amount":10,"traceId":"ORD-32ee8a71"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-32ee8a71] [ORDER:ORD-32ee8a71] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:40:26.362854
Received inventory.reserved: {"orderNumber":"ORD-32ee8a71","orderId":44,"amount":10,"traceId":"ORD-32ee8a71"}
Received payment.success {"orderId":44,"orderNumber":"ORD-32ee8a71","traceId":"ORD-32ee8a71"}
Payment success pending for ORD-32ee8a71
Failed to process inventory.reserved
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '44']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:166)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy160.save(Unknown Source)
	at com.deepana.orderservice.kafka.listener.InventoryEventListener.handleInventoryReserved(InventoryEventListener.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '44']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 36 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 61 common frames omitted
Order event sent: {"orderId":45,"orderNumber":"ORD-81e1d1aa","userId":135,"totalAmount":100,"items":[{"productId":1,"quantity":1,"price":100}],"createdAt":"2026-01-29T22:41:13.2380171","traceId":"ORD-81e1d1aa"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-81e1d1aa] [ORDER:ORD-81e1d1aa] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:41:13.242602200
Received order: ORD-81e1d1aa
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-81e1d1aa] [ORDER:ORD-81e1d1aa] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:41:13.252944
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-81e1d1aa] [ORDER:ORD-81e1d1aa] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:41:13.252944
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-81e1d1aa] [ORDER:ORD-81e1d1aa] [STEP:FOUND_PRODUCT_1] [STATUS:SUCCESS] at 2026-01-29T22:41:13.257349800
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-81e1d1aa] [ORDER:ORD-81e1d1aa] [STEP:RESERVED_PRODUCT_1] [STATUS:SUCCESS] at 2026-01-29T22:41:13.264012200
Inventory reserved event sent: {"orderNumber":"ORD-81e1d1aa","orderId":45,"amount":100,"traceId":"ORD-81e1d1aa"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-81e1d1aa] [ORDER:ORD-81e1d1aa] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:41:13.264711400
Received inventory.reserved {"orderNumber":"ORD-81e1d1aa","orderId":45,"amount":100,"traceId":"ORD-81e1d1aa"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-81e1d1aa] [ORDER:ORD-81e1d1aa] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T22:41:13.289518900
Inventory reserved for ORD-81e1d1aa
Received payment.success {"orderId":45,"orderNumber":"ORD-81e1d1aa","traceId":"ORD-81e1d1aa"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-81e1d1aa] [ORDER:ORD-81e1d1aa] [STEP:PAYMENT_SUCCESS] [STATUS:SUCCESS] at 2026-01-29T22:41:13.318072700
Order ORD-81e1d1aa COMPLETED
Starting OrderServiceApplication using Java 17.0.12 with PID 36728 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.421 seconds (process running for 3.651)
Order event sent: {"orderId":46,"orderNumber":"ORD-fc8df66d","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T22:46:40.7756224","traceId":"ORD-fc8df66d"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-fc8df66d] [ORDER:ORD-fc8df66d] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:46:40.876542
Received order: ORD-fc8df66d
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-fc8df66d] [ORDER:ORD-fc8df66d] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:46:40.899680100
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-fc8df66d] [ORDER:ORD-fc8df66d] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:46:40.899680100
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-fc8df66d] [ORDER:ORD-fc8df66d] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:46:40.904121400
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-fc8df66d] [ORDER:ORD-fc8df66d] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:46:40.906062800
Inventory reserved event sent: {"orderNumber":"ORD-fc8df66d","orderId":46,"amount":100,"traceId":"ORD-fc8df66d"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-fc8df66d] [ORDER:ORD-fc8df66d] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:46:40.906569100
Received inventory.reserved: {"orderNumber":"ORD-fc8df66d","orderId":46,"amount":100,"traceId":"ORD-fc8df66d"}
Received payment.success {"orderId":46,"orderNumber":"ORD-fc8df66d","traceId":"ORD-fc8df66d"}
Payment success pending ORD-fc8df66d
Failed to process inventory.reserved
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '46']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:166)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy160.save(Unknown Source)
	at com.deepana.orderservice.kafka.listener.InventoryEventListener.handleInventoryReserved(InventoryEventListener.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '46']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 36 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 61 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 26320 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.951 seconds (process running for 4.178)
Order event sent: {"orderId":47,"orderNumber":"ORD-3da72170","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T22:52:13.2527347","traceId":"ORD-3da72170"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-3da72170] [ORDER:ORD-3da72170] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T22:52:13.390661200
Received order: ORD-3da72170
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3da72170] [ORDER:ORD-3da72170] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T22:52:13.403044400
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3da72170] [ORDER:ORD-3da72170] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T22:52:13.403044400
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3da72170] [ORDER:ORD-3da72170] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:52:13.410763600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3da72170] [ORDER:ORD-3da72170] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T22:52:13.413048800
Inventory reserved event sent: {"orderNumber":"ORD-3da72170","orderId":47,"amount":100,"traceId":"ORD-3da72170"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-3da72170] [ORDER:ORD-3da72170] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T22:52:13.414053500
Received payment.success {"orderId":47,"orderNumber":"ORD-3da72170","traceId":"ORD-3da72170"}
Received inventory.reserved {"orderNumber":"ORD-3da72170","orderId":47,"amount":100,"traceId":"ORD-3da72170"}
Payment success pending ORD-3da72170
[SAGA] [SERVICE:ORDER] [TRACE:ORD-3da72170] [ORDER:ORD-3da72170] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T22:52:13.519283800
Inventory reserved for ORD-3da72170
Failed to process inventory.reserved
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '47']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at com.deepana.orderservice.service.OrderServiceImpl$$SpringCGLIB$$0.handleInventoryReserved(<generated>)
	at com.deepana.orderservice.kafka.InventoryEventConsumer.handleReserved(InventoryEventConsumer.java:36)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '47']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 32 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 57 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 35112 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.855 seconds (process running for 4.086)
Order event sent: {"orderId":48,"orderNumber":"ORD-382664a4","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T23:01:22.3226317","traceId":"ORD-382664a4"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-382664a4] [ORDER:ORD-382664a4] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T23:01:22.423807
Received order: ORD-382664a4
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-382664a4] [ORDER:ORD-382664a4] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T23:01:22.453861300
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-382664a4] [ORDER:ORD-382664a4] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T23:01:22.454493400
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-382664a4] [ORDER:ORD-382664a4] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:01:22.462092400
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-382664a4] [ORDER:ORD-382664a4] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:01:22.465092
Inventory reserved event sent: {"orderNumber":"ORD-382664a4","orderId":48,"amount":100,"traceId":"ORD-382664a4"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-382664a4] [ORDER:ORD-382664a4] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T23:01:22.466891300
Received inventory.reserved {"orderNumber":"ORD-382664a4","orderId":48,"amount":100,"traceId":"ORD-382664a4"}
Received payment.success {"orderId":48,"orderNumber":"ORD-382664a4","traceId":"ORD-382664a4"}
Failed to process inventory.reserved
org.springframework.dao.InvalidDataAccessApiUsageException: No active transaction
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:394)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:112)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:556)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:346)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:157)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy163.findByIdForUpdate(Unknown Source)
	at com.deepana.orderservice.service.OrderServiceImpl.loadForUpdate(OrderServiceImpl.java:342)
	at com.deepana.orderservice.service.OrderServiceImpl.doHandleInventoryReserved(OrderServiceImpl.java:153)
	at com.deepana.orderservice.service.OrderServiceImpl.lambda$handleInventoryReserved$2(OrderServiceImpl.java:141)
	at com.deepana.orderservice.service.OrderServiceImpl.retry(OrderServiceImpl.java:357)
	at com.deepana.orderservice.service.OrderServiceImpl.handleInventoryReserved(OrderServiceImpl.java:141)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:715)
	at com.deepana.orderservice.service.OrderServiceImpl$$SpringCGLIB$$0.handleInventoryReserved(<generated>)
	at com.deepana.orderservice.kafka.InventoryEventConsumer.handleReserved(InventoryEventConsumer.java:36)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: jakarta.persistence.TransactionRequiredException: No active transaction
	at org.hibernate.internal.AbstractSharedSessionContract.prepareForQueryExecution(AbstractSharedSessionContract.java:589)
	at org.hibernate.internal.SessionImpl.prepareForQueryExecution(SessionImpl.java:155)
	at org.hibernate.query.spi.AbstractSelectionQuery.beforeQuery(AbstractSelectionQuery.java:181)
	at org.hibernate.query.spi.AbstractSelectionQuery.beforeQueryHandlingFetchProfiles(AbstractSelectionQuery.java:169)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:150)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResultOrNull(AbstractSelectionQuery.java:330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:414)
	at jdk.proxy2/jdk.proxy2.$Proxy188.getSingleResultOrNull(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:328)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:99)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:164)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:154)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:169)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:167)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:146)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:133)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:371)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
	... 41 common frames omitted
Failed to process payment.success
org.springframework.dao.InvalidDataAccessApiUsageException: No active transaction
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:394)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:112)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:556)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:346)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:157)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy163.findByIdForUpdate(Unknown Source)
	at com.deepana.orderservice.service.OrderServiceImpl.loadForUpdate(OrderServiceImpl.java:342)
	at com.deepana.orderservice.service.OrderServiceImpl.doHandlePaymentSuccess(OrderServiceImpl.java:234)
	at com.deepana.orderservice.service.OrderServiceImpl.lambda$handlePaymentSuccess$4(OrderServiceImpl.java:222)
	at com.deepana.orderservice.service.OrderServiceImpl.retry(OrderServiceImpl.java:357)
	at com.deepana.orderservice.service.OrderServiceImpl.handlePaymentSuccess(OrderServiceImpl.java:222)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:715)
	at com.deepana.orderservice.service.OrderServiceImpl$$SpringCGLIB$$0.handlePaymentSuccess(<generated>)
	at com.deepana.orderservice.kafka.PaymentEventConsumer.handleSuccess(PaymentEventConsumer.java:34)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: jakarta.persistence.TransactionRequiredException: No active transaction
	at org.hibernate.internal.AbstractSharedSessionContract.prepareForQueryExecution(AbstractSharedSessionContract.java:589)
	at org.hibernate.internal.SessionImpl.prepareForQueryExecution(SessionImpl.java:155)
	at org.hibernate.query.spi.AbstractSelectionQuery.beforeQuery(AbstractSelectionQuery.java:181)
	at org.hibernate.query.spi.AbstractSelectionQuery.beforeQueryHandlingFetchProfiles(AbstractSelectionQuery.java:169)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:150)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResultOrNull(AbstractSelectionQuery.java:330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:414)
	at jdk.proxy2/jdk.proxy2.$Proxy188.getSingleResultOrNull(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:328)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:99)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:164)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:154)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:169)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:167)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:146)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:133)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:371)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
	... 41 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 38268 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.606 seconds (process running for 3.832)
Order event sent: {"orderId":49,"orderNumber":"ORD-c073a752","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T23:05:09.3790951","traceId":"ORD-c073a752"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-c073a752] [ORDER:ORD-c073a752] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T23:05:09.478002100
Received order: ORD-c073a752
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c073a752] [ORDER:ORD-c073a752] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T23:05:09.508321800
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c073a752] [ORDER:ORD-c073a752] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T23:05:09.508321800
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c073a752] [ORDER:ORD-c073a752] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:05:09.514322600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c073a752] [ORDER:ORD-c073a752] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:05:09.516458600
Inventory reserved event sent: {"orderNumber":"ORD-c073a752","orderId":49,"amount":100,"traceId":"ORD-c073a752"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-c073a752] [ORDER:ORD-c073a752] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T23:05:09.518457900
Received inventory.reserved {"orderNumber":"ORD-c073a752","orderId":49,"amount":100,"traceId":"ORD-c073a752"}
Received payment.failed {"orderId":49,"orderNumber":"ORD-c073a752","reason":"Payment gateway declined","traceId":"ORD-c073a752"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-c073a752] [ORDER:ORD-c073a752] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T23:05:09.630910200
Payment failed pending ORD-c073a752
Inventory reserved ORD-c073a752
Failed to process payment.failed
org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '49']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at com.deepana.orderservice.service.OrderServiceImpl$$SpringCGLIB$$0.handlePaymentFailure(<generated>)
	at com.deepana.orderservice.kafka.PaymentEventConsumer.handleFailed(PaymentEventConsumer.java:56)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?] for entity [com.deepana.orderservice.entity.Order with id '49']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 32 common frames omitted
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update orders set created_at=?,fulfillment_type=?,order_number=?,payment_pending=?,payment_type=?,status=?,total_amount=?,updated_at=?,user_id=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 57 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 4240 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 3.634 seconds (process running for 3.878)
Order event sent: {"orderId":50,"orderNumber":"ORD-5ddf6212","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T23:07:46.4807314","traceId":"ORD-5ddf6212"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-5ddf6212] [ORDER:ORD-5ddf6212] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T23:07:46.675814100
Received order: ORD-5ddf6212
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-5ddf6212] [ORDER:ORD-5ddf6212] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T23:07:46.700301200
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-5ddf6212] [ORDER:ORD-5ddf6212] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T23:07:46.700301200
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-5ddf6212] [ORDER:ORD-5ddf6212] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:07:46.703302100
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-5ddf6212] [ORDER:ORD-5ddf6212] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:07:46.705820900
Inventory reserved event sent: {"orderNumber":"ORD-5ddf6212","orderId":50,"amount":100,"traceId":"ORD-5ddf6212"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-5ddf6212] [ORDER:ORD-5ddf6212] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T23:07:46.705820900
Received inventory.reserved: {"orderNumber":"ORD-5ddf6212","orderId":50,"amount":100,"traceId":"ORD-5ddf6212"}
Received payment.success {"orderId":50,"orderNumber":"ORD-5ddf6212","traceId":"ORD-5ddf6212"}
Order ORD-5ddf6212 CONFIRMED
[SAGA] [SERVICE:ORDER] [TRACE:null] [ORDER:ORD-5ddf6212] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T23:07:46.805476600
Failed to process payment.success
org.springframework.orm.jpa.JpaSystemException: Entity 'com.deepana.orderservice.entity.Order' has no version and may not be locked at level OPTIMISTIC
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:223)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:105)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:556)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:346)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:157)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByIdForUpdate(Unknown Source)
	at com.deepana.orderservice.service.OrderServiceImpl.handlePaymentSuccess(OrderServiceImpl.java:225)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:133)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:371)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at com.deepana.orderservice.service.OrderServiceImpl$$SpringCGLIB$$0.handlePaymentSuccess(<generated>)
	at com.deepana.orderservice.kafka.PaymentEventConsumer.handleSuccess(PaymentEventConsumer.java:34)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:168)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:48)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:80)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:488)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:425)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:52)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2880)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2790)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2632)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2526)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2164)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1541)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1479)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1348)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: org.hibernate.HibernateException: Entity 'com.deepana.orderservice.entity.Order' has no version and may not be locked at level OPTIMISTIC
	at org.hibernate.event.internal.DefaultPostLoadEventListener.onPostLoad(DefaultPostLoadEventListener.java:64)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.engine.internal.StatefulPersistenceContext.processLoadedEntityHolder(StatefulPersistenceContext.java:468)
	at org.hibernate.engine.internal.StatefulPersistenceContext.postLoad(StatefulPersistenceContext.java:433)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesSourceProcessingStateStandardImpl.finishUp(JdbcValuesSourceProcessingStateStandardImpl.java:154)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:166)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:31)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:211)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:100)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:63)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:137)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:128)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:427)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:355)
	at org.hibernate.query.sqm.internal.SqmQueryImpl.doList(SqmQueryImpl.java:374)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:153)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResultOrNull(AbstractSelectionQuery.java:330)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:328)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:99)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:164)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:154)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:169)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:167)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:146)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:133)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:371)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
	... 43 common frames omitted
Starting OrderServiceApplication using Java 17.0.12 with PID 22416 (F:\PROJECTS\git\distributed-order-system\order-service\target\classes started by deepa in F:\PROJECTS\git\distributed-order-system)
No active profile set, falling back to 1 default profile: "default"
Started OrderServiceApplication in 8.927 seconds (process running for 9.702)
Order event sent: {"orderId":51,"orderNumber":"ORD-2e357f1f","userId":135,"totalAmount":100,"items":[{"productId":2,"quantity":1,"price":100}],"createdAt":"2026-01-29T23:09:40.8563445","traceId":"ORD-2e357f1f"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-2e357f1f] [ORDER:ORD-2e357f1f] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T23:09:40.968238800
Received order: ORD-2e357f1f
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-2e357f1f] [ORDER:ORD-2e357f1f] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T23:09:40.988988
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-2e357f1f] [ORDER:ORD-2e357f1f] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T23:09:40.988988
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-2e357f1f] [ORDER:ORD-2e357f1f] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:09:40.993522600
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-2e357f1f] [ORDER:ORD-2e357f1f] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:09:40.996230100
Inventory reserved event sent: {"orderNumber":"ORD-2e357f1f","orderId":51,"amount":100,"traceId":"ORD-2e357f1f"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-2e357f1f] [ORDER:ORD-2e357f1f] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T23:09:40.996230100
Received inventory.reserved: {"orderNumber":"ORD-2e357f1f","orderId":51,"amount":100,"traceId":"ORD-2e357f1f"}
Received payment.success {"orderId":51,"orderNumber":"ORD-2e357f1f","traceId":"ORD-2e357f1f"}
Order ORD-2e357f1f CONFIRMED
[SAGA] [SERVICE:ORDER] [TRACE:null] [ORDER:ORD-2e357f1f] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T23:09:41.136698500
[SAGA] [SERVICE:ORDER] [TRACE:ORD-2e357f1f] [ORDER:ORD-2e357f1f] [STEP:PAYMENT_SUCCESS] [STATUS:SUCCESS] at 2026-01-29T23:09:41.145600200
Order ORD-2e357f1f COMPLETED
Order event sent: {"orderId":52,"orderNumber":"ORD-bb674092","userId":135,"totalAmount":100000,"items":[{"productId":2,"quantity":1,"price":100000}],"createdAt":"2026-01-29T23:10:03.9024548","traceId":"ORD-bb674092"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-bb674092] [ORDER:ORD-bb674092] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T23:10:03.907167100
Received order: ORD-bb674092
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-bb674092] [ORDER:ORD-bb674092] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T23:10:03.918744500
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-bb674092] [ORDER:ORD-bb674092] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T23:10:03.918744500
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-bb674092] [ORDER:ORD-bb674092] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:10:03.926671300
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-bb674092] [ORDER:ORD-bb674092] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:10:03.931644500
Inventory reserved event sent: {"orderNumber":"ORD-bb674092","orderId":52,"amount":100000,"traceId":"ORD-bb674092"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-bb674092] [ORDER:ORD-bb674092] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T23:10:03.932635300
Received inventory.reserved: {"orderNumber":"ORD-bb674092","orderId":52,"amount":100000,"traceId":"ORD-bb674092"}
Order ORD-bb674092 CONFIRMED
[SAGA] [SERVICE:ORDER] [TRACE:null] [ORDER:ORD-bb674092] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T23:10:03.960364300
Received payment.success {"orderId":52,"orderNumber":"ORD-bb674092","traceId":"ORD-bb674092"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-bb674092] [ORDER:ORD-bb674092] [STEP:PAYMENT_SUCCESS] [STATUS:SUCCESS] at 2026-01-29T23:10:03.969529400
Order ORD-bb674092 COMPLETED
Order event sent: {"orderId":53,"orderNumber":"ORD-6d6108fd","userId":135,"totalAmount":1,"items":[{"productId":2,"quantity":1,"price":1}],"createdAt":"2026-01-29T23:10:14.1216136","traceId":"ORD-6d6108fd"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-6d6108fd] [ORDER:ORD-6d6108fd] [STEP:ORDER_CREATED] [STATUS:SUCCESS] at 2026-01-29T23:10:14.125682300
Received order: ORD-6d6108fd
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-6d6108fd] [ORDER:ORD-6d6108fd] [STEP:RECEIVED_ORDER] [STATUS:SUCCESS] at 2026-01-29T23:10:14.138885
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-6d6108fd] [ORDER:ORD-6d6108fd] [STEP:CHECKING_STOCK] [STATUS:SUCCESS] at 2026-01-29T23:10:14.138885
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-6d6108fd] [ORDER:ORD-6d6108fd] [STEP:FOUND_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:10:14.143198100
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-6d6108fd] [ORDER:ORD-6d6108fd] [STEP:RESERVED_PRODUCT_2] [STATUS:SUCCESS] at 2026-01-29T23:10:14.147955100
Inventory reserved event sent: {"orderNumber":"ORD-6d6108fd","orderId":53,"amount":1,"traceId":"ORD-6d6108fd"}
[SAGA] [SERVICE:INVENTORY] [TRACE:ORD-6d6108fd] [ORDER:ORD-6d6108fd] [STEP:EVENT_PUBLISHED] [STATUS:SUCCESS] at 2026-01-29T23:10:14.148406500
Received inventory.reserved: {"orderNumber":"ORD-6d6108fd","orderId":53,"amount":1,"traceId":"ORD-6d6108fd"}
Order ORD-6d6108fd CONFIRMED
[SAGA] [SERVICE:ORDER] [TRACE:null] [ORDER:ORD-6d6108fd] [STEP:INVENTORY_RESERVED] [STATUS:SUCCESS] at 2026-01-29T23:10:14.179660100
Received payment.success {"orderId":53,"orderNumber":"ORD-6d6108fd","traceId":"ORD-6d6108fd"}
[SAGA] [SERVICE:ORDER] [TRACE:ORD-6d6108fd] [ORDER:ORD-6d6108fd] [STEP:PAYMENT_SUCCESS] [STATUS:SUCCESS] at 2026-01-29T23:10:14.190761800
Order ORD-6d6108fd COMPLETED
